# KPMG Design System

**Version: 0.0.5**

**Last Updated on: Jul 7,2023**

## How to work with this system

### This is a Mobile-First design system.

This **README** will cover how to work with the **KPMG Design System** files found in:

**_ui.frontend/src/main/webpack/site/_**

and

**_ui.frontend/src/main/webpack/components/_**

> **Note: Since this is an evolving project it may be subject to change, which will be reflected in this file, an email will be sent out to all front end developers when this file is updated. If you find any errors or issues in this document please notify the KPMG Front End team and we will address them.**

---

### 1. main.scss

This is the main entry point for all **SASS** files. It currently imports everything from:

**_ui.frontend/src/main/webpack/site/_**

as well as

**_ui.frontend/src/main/webpack/components/_**.

> **Note: This file for the most part will not change and should not be modified unless a KPMG developer is consulted.**

---

### 2. \_utils.scss

This file generates some common utility **CSS** classes. All of these classes will be prefixed with **'.utils-'** to make their purpose clear to other developers and content authors.

> **Important ! : These are meant to be used in the future primarily by content authors when adding policy styles to AEM author/publish, do not reference these classes in other SASS files ex. _ui.frontend/src/main/webpack/components/_.**

The utility classes currently offer some options for setting a handful of commonly used background colors:

**ex.**

```sass
.utils-background-kpmg-blue {
    background: #00338d
}
```

Also there are margin/padding utils for spacing:

**ex.**

```sass
//Margin examples
.utils-margin--base {
    margin: 1rem
}

.utils-margin-horizontal--base {
    margin-left: 1rem;
    margin-right: 1rem
}

.utils-margin-vertical--base {
    margin-bottom: 1rem;
    margin-top: 1rem
}

//Padding examples
.utils-padding-vertical--xx-small {
    padding-bottom: .25rem;
    padding-top: .25rem
}

.utils-padding-top--xx-small {
    padding-top: .25rem
}

.utils-padding-right--xx-small {
    padding-right: .25rem
}
```

And some classes for quickly changing font-size:

**ex.**

```sass
.utils-font-size--small {
    font-size: .875rem
}

.utils-font-size--base {
    font-size: 1rem
}

.utils-font-size--medium {
    font-size: 1.125rem
}

.utils-font-size--large {
    font-size: 1.25rem
}
```

To see all the available utility classes, please look at the compiled **CSS** file at:

**_ui.apps/src/main/content/jcr_root/apps/kpmg/clientlibs/clientlib-site_**

---

### 3. \_tokens.scss

This file is generated by the **[design token framework](https://amzn.github.io/style-dictionary/#/)** found in **_ui.frontend/style-dictionary_**.

> **Note: Please see README in _ui.frontend/style-dictionary/_ to learn how we are utilizing these tokens, and how to add more if needed.**

> **Important ! : Please note that the sizes found in global.size.base.json are based on the [Carbon Spacing System](https://carbondesignsystem.com/guidelines/spacing/overview/). This size scale has been mapped to the margin/padding _Alias_ tokens. This is a standardized scale that can be found in many design systems and should be used for spacing.**

> **Important ! : Never directly edit the values of any design tokens in this file! This file is auto generated and your changes will be wiped out when building to the cloud instance of AEM.**

---

### 4. \_mixins.scss

This file imports the majority of the common **SASS** style mixins we are using across the site/components.

**Mixins are essentially re-useable styles that can be applied to most components to avoid writing duplicate code.**

**[Please see this page to learn more on how to work with SASS mixins](https://sass-lang.com/documentation/at-rules/mixin)**.

This file currently imports four different categories of mixins. The imported files can be found here:

**_ui.frontend/src/main/webpack/site/mixins/_**

The current existing categories are as follows:

```sass
@import "mixins/mediaqueries";
@import "mixins/typography";
@import "mixins/elements";
@import "mixins/misc";
```

> **Note: If you decide to add a new mixin, please place them into one of these categories, if you are unsure which one to classify them under, please add it to the _misc_ category for now.**

### An important note about Typography mixins

> **Important ! : We currently have _Typography_ mixins for every font style seen in the Figma Typography file. Every one of these mixins contain the proper font family, size, line-height, letter spacing, as well as responsive values for all views.** > **_Please try to use these mixins before writing your own font styles, this is to avoid writing unneeded duplicate CSS throughout the site_. If you find a case where the font size or color needs to be changed, please include the mixin and make your overrides below it in the component stylesheet. See the section labeled `_mixins.scss cont'd` for more information.**

### An important note about the Mobile-First breakpoint mixins

> **Important ! : With regards to the breakpoint mixins, please note we are utilizing a _mobile-first_ approach to the styling on this website. The default styling of any component is applied first to the _mobile ( 360px up to 767px )_ view, when adding styles for the _tablet ( >= 768px )_ view please wrap your changes in the _tablet_ mixin, this applies for _desktop-small ( >= 1024px )_ and _desktop-medium ( >= 1366px and up )_ view:**

**ex.**

```sass
@mixin typography-breakpoint-example {

  //Default style is Mobile (360px up to 767px)
  font-size: $alias-font-size-x-large;
  line-height: $alias-fonts-line-height-x-large;

  //Tablet (>= 768px)
  @include tablet {
    font-size: $alias-font-size-xx-large;
    line-height: $alias-fonts-line-height-xx-large;
  }

  //Desktop Small (>= 1024px)
  @include desktop-small {
    font-size: $alias-font-size-xxx-large;
    line-height: $alias-fonts-line-height-xxx-large;
  }

  //Desktop Medium (>= 1366px and up)
  @include desktop-medium {
    font-size: $alias-font-size-4x-large;
    line-height: $alias-fonts-line-height-4x-large;
  }
}
```

> **Note: In the future there will be a Desktop Large breakpoint that will most likely target >= 1920px and up, for now Desktop Medium is the highest breakpoint that can be applied.**

---

### \_mixins.scss cont'd

> **Important ! : If you feel you need to add a mixin to this file please feel free, in order to keep them organized, there are two things to keep in mind when creating/applying a mixin:**

**_1. Before creating a new mixin, please check the existing ones to see if there is something that you can already use._**

_If you find a mixin that does primarily what you need but is missing one or two styling properties you require, consider including the mixin in your component stylesheet and adding the extra styles below the include when possible:_

**ex.**

```sass
.cmp-button--secondary & {
	@include button-secondary;
    cursor: grab;
}

.cmp-text {
	@include typography-body-default-link;
	color: $light-theme-link-text;
}
```

**_2. Make sure new mixins do not have any styling references to specific components or use cases._**

_We always want to make our mixins generic as much as possible so they can be utilized in multiple places without causing **CSS** overrides/conflicts:_

**ex.**

```sass
@mixin typography-heading-one {
  //Default style

  //Mobile
  font-family: $alias-fonts-heading-one-font-family;
  color: $alias-color-heading-one;
  font-size: $alias-font-size-4x-large; // 2.5rem/40px
  line-height: $alias-fonts-line-height-6x-large; // 3rem/48px
  letter-spacing: $alias-fonts-heading-one-letter-spacing;

  //Desktop
  @include desktop-small {
    font-size: $alias-font-size-6x-large; // 3.75rem/60px
    line-height: $alias-fonts-line-height-8x-large; // 4.5rem/72px
  }
}
```

> **Note: This example is intended to be applied to an h1 in any component, it contains more generic design token references. It would also be preferred that alias level tokens are used in mixins, please see the style-dictionary README in _ui.frontend/style-dictionary/_ for more information.**

---

### 5. \_icons.scss

This file currently only contains styling for the **[Material Icons](https://fonts.google.com/icons?icon.set=Material+Icons)** library, it contains the references to the **font-face**, some mixins to quickly include in your component any particular style of icon. Currently **Material Icons** provides five styles: **_filled, outlined, round, sharp, and two-tone_**, there are also some **CSS** classes available for when the icon is referred to in **HTML**.

**ex.**

```sass
@mixin material-icons-filled {
  @include icon-render-style;
  font-family: $global-fonts-font-family-materialicons-filled;
}

@mixin material-icons-outlined {
  @include icon-render-style;
  font-family: $global-fonts-font-family-materialicons-outlined;
}
```

#### Please always use the icon mixins provided in this file, when applying an icon to your component.

As you can see in the above mixin example we are including some rendering styles `@include icon-render-style;` for each icon mixin. This is to normalize the icon for compatibility across browsers.

**Use examples:**

**1.** Referencing via **CSS**

```sass
span {
  &:after {
  	@include material-icons-filled;
  	content: "home";
  }
}
```

> **Note: To get a particular icon ID (ex. 'home'. 'chevron_right', 'play_arrow', etc.), please go to [the Material Icons page and click on the icon you need](https://fonts.google.com/icons?selected=Material+Icons+Outlined:home:&icon.style=Filled&icon.set=Material+Icons), in this particular example we see the 'home'\_ icon is highlighted as an example. You will also notice you can use either the human readable string as well as the codepoint string to refer to the icon you want. It is recommended to use the human readable string always for better comprehension of what the icon is for, unless you find a possible use case where the codepoint is better suited.**

**2.** Referencing via **HTML**

```html
<span class="material-icons-filled">home</span>
<span class="material-icons-outlined">chevron_right</span>
```

If you require another way to include your icon, please contact one of the KPMG developers. More information about working with **Material Icons** can be found **[here](https://developers.google.com/fonts/docs/material_icons)**.

> **Note: The Material Icons set currently _does not_ incorporate social media icons in its set, we are currently looking to rectify this issue. We should have a solution shortly. For now please use a placeholder material icon instead.**

---

### 6. \_fonts.scss

This file currently includes the **font-face** values for the **[Open Sans](https://fonts.google.com/specimen/Open+Sans)** font which will be used throughout the site. Currently the following variants are available for use: **_regular, semibold, bold, condensed regular, condensed bold_**.

The typography mixins which utilize the **font-face** can be found in:

**_ui.frontend/src/main/webpack/site/mixins/\_typography.scss_**

#### An important note about Typography mixins

> **Important ! : We currently have _Typography_ mixins for every font style seen in the Figma Typography file. Every one of these mixins contain the proper font family, size, line-height, letter spacing, as well as responsive values for all views.** > **_Please try to use these mixins before writing your own font styles, this is to avoid writing unneeded duplicate CSS throughout the site_. If you find a case where the font size or color needs to be changed, please include the mixin and make your overrides below it in the component stylesheet. See the section labeled `_mixins.scss cont'd` for more information.**

---

### 7. \_base.scss

This file contains all the global **CSS** styles that are automatically applied to **HTML** elements in the site. Currently it contains just a handful of global styles, primarily typography styles for **html**, **body**, **h1**, **h2**, **etc**. These styles are applied via the typography mixins and should not need to be changed.

> **Important ! : Try to minimize how many default styles you add in this file, this is because it affects the site on a global level and may cause unintended styling issues in other parts of the site that may not be noticed immediately by QA.**

---

### 8. components/

These files can be found here:

**_ui.frontend/src/main/webpack/components/_**

They refer to the custom styles of specific components. These files utilize common mixins in addition to component-level specific design tokens. For an example of how these files are written, please see the standard teaser file at:

**_ui.frontend/src/main/webpack/components/\_standardteaser.scss_**

#### Please avoid using the !important declaration as much as possible in these files.

When applying custom **CSS** styles to your component, avoid using the **`!important`** declaration:

ex.

```sass
width: $container-width-small !important;
```

Because we are encapsulating our styles for each component using **[BEM](https://getbem.com/)**, and there are few default styles in the **\_base.scss** file. We should not have to use the **`!important`** declaration for the most part.

The reason for avoiding this declaration is because it sets the current value to completely override any other competing values, and will make these styles difficult to update/maintain by other developers.

If you are facing issues where you must use this declaration please try to utilize **[CSS Specificity instead to achieve your goal.](https://css-tricks.com/specifics-on-css-specificity/)**

> **Note: When applying styles to these components, please try to utilize existing mixins to apply as much styling as you can, and then add custom CSS styles in this file to complete the styling. See item #4 in this README to learn more about working with mixins.**

---

### 9. Right-To-Left (RTL) Languages Support

RTL support is automated via https://github.com/elchininet/postcss-rtlcss
This is a PostCSS plugin that automatically flips LTR styles to RTL. For example, if you define:

```css
.my-class {
  margin-top: 2px;
  margin-left: 10px;
}
```

the plugn automatically generates:

```css
.my-class {
  margin-top: 2px;
  margin-left: 10px;
}

[dir="rtl"] .my-class {
  margin-right: 10px;
}
```

#### Using Control Directives

For properties that the plugin does not support directly, you can use the [Control Directives](https://github.com/elchininet/postcss-rtlcss#control-directives)

As an example, our buttons include a `chevron_right` icon for buttons. However, with a RTL language, we want to use `chevron_left` icon.

for that we can use [`/*rtl:{value}*/`](https://github.com/elchininet/postcss-rtlcss#rtlvalue) directive:

For example, this scss:

```scss
.button {
  &:after {
    content: "chevron_right" #{"/*!rtl: 'chevron_left' */"};
  }
}
```

would generate this css

```css
.button:after {
  content: "chevron_right";
}

[dir="rtl"] .button:after {
  content: "chevron_left";
}
```

Note the use of `#{"/*!rtl: 'chevron_left' */"};` instead of `/*!rtl: 'chevron_left' */`
This is due to SCSS compressed mode. see [explanation](https://github.com/MohammadYounes/rtlcss/issues/221)

---

### 9. Light/Dark Theme

The design for KPMG.com has a `dark/light` theme, meaning that each component would have a `light` variation and a `dark` variation.

> The `dark` variation of a component is used when the container background is dark, and the `light` variation is used when the container is light.
> As an example, a button should show its dark variation (ex. have a `white` backgoud with `kpmg blue` text color) when the _parent container_ is set to dark (ex. background is`white` or `grey`).

From a design perspective, this creates a challenege, we need to show the `dark` variation of components IF the closest container is set to use the `dark` theme (AKA has a dark background).

> In CSS, you cannot lookup the parent class, so until the [:has](https://developer.mozilla.org/en-US/docs/Web/CSS/:has) selector has wide browser support, we have to use anoter approach

#### Enter Custom propertiesa

[This excellent article](https://css-tricks.com/using-custom-property-stacks-to-tame-the-cascade/) describes our approach for themeing.

##### The Development Approach

Every component that needs to take advantage of theming, must do so with the help of `dark-theme` and `light-theme` mixins.

As an example, refer to the text list component (/ui.frontend/src/main/webpack/components/\_text-list.scss)

A text list needs to change its icon color based on the theme, so it would do:

```scss
@include light-theme {
  --texlist-rounded-icon-color: #{$global-color-brand-purple}; // purple
}

@include dark-theme {
  --texlist-rounded-icon-color: #{$global-color-brand-white}; // white
}

.textlist {
  li.cmp-text-list__item {
    &::before {
      // Other CSS properties that are unaffected by theme change go here

      // Color is now dependent on theme changes
      color: var(--texlist-rounded-icon-color);
    }
  }
}
```

Notice how the color property is the only property that changes in response to theme change, if theme is light, color is purple, if theme is dark, color is white.

This development style should be used across all components that should change in some way due to theme changes,

##### The AEM Style Policy approach (and backgrounds)

When defining a style policy for a component that contains other components (container, accordion, column control ...etc)
If the container needs to change backgrounds, use the utility background classes in the policy, and add the theme class as well. The theme classes we support are `dark-theme` and `light-theme`

Example: if the Column Control component needs to set a `KPMG Blue` background then the style policy for that would be `utils-background-kpmg-blue dark-theme`

> Notice that `dark-theme` was added so that all child componments added under the Column Control would show their `dark` theme variation.

Similarly, if the Column Control component needs to set a `White` background then the style policy for that would be `utils-background-grey-100 light-theme`

> Notice that `light-theme` was added so that all child componments added under the Column Control would show their `light` theme variation.
